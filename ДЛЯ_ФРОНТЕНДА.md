# ИНСТРУКЦИЯ ДЛЯ ФРОНТЕНДА

## 1. СКАЧАТЬ КОД

```bash
git clone https://github.com/citec-spbu/coach-assistant.git
cd coach-assistant/dance_classifier
```

## 2. СКАЧАТЬ МОДЕЛЬ С ОБЛАКА

**ССЫЛКА:** https://cloud.mail.ru/public/DG9E/EuZWkp6gn

**СКАЧАТЬ:**
- `models/best_model_20pct.pth` (61 MB)
- `yolov8m-pose.pt` (52 MB)

**ПОЛОЖИТЬ:**
- `best_model_20pct.pth` → `coach-assistant/dance_classifier/models/`
- `yolov8m-pose.pt` → `coach-assistant/`

## 3. УСТАНОВИТЬ ЗАВИСИМОСТИ

```bash
pip install -r requirements.txt
```

## 4. КОД ДЛЯ ИСПОЛЬЗОВАНИЯ

```python
from dance_classifier.inference.predict import DanceClassifierPredictor

predictor = DanceClassifierPredictor(
    model_path="dance_classifier/models/best_model_20pct.pth",
    metadata_path="dance_classifier/data/metadata.json",
    scaler_path="dance_classifier/data/scaler.pkl",
    label_encoder_path="dance_classifier/data/label_encoder.pkl"
)

result = predictor.predict_from_poses("path/to/poses.jsonl")
```

## 5. ЧТО НА ВЫХОДЕ

```json
{
    "success": true,
    "predicted_class": "FootChange",
    "confidence": 0.806,
    "spatial_similarity": {
        "score": 78.7,
        "error_segments": [...]
    },
    "timing": {
        "score": 76.2,
        "bpm": 128.3,
        "error_segments": [...]
    },
    "balance": {
        "score": 97.4,
        "error_segments": [...]
    },
    "classifier_clarity": {
        "score": 86.7,
        "error_segments": [...]
    }
}
```

## 6. МЕТРИКИ

- **spatial_similarity** (Техника): DTW-сравнение с эталоном, 0-100
- **timing** (Тайминг): Шаги vs музыка, 0-100
- **balance** (Баланс): Стабильность центра масс, 0-100
- **classifier_clarity** (Уверенность): Качество предсказания, 0-100

## 7. ПУТИ К ФАЙЛАМ

### С GITHUB:
- `dance_classifier/data/metadata.json`
- `dance_classifier/data/scaler.pkl`
- `dance_classifier/data/label_encoder.pkl`
- Весь код в `dance_classifier/`

### С ОБЛАКА MAIL.RU:
https://cloud.mail.ru/public/DG9E/EuZWkp6gn

- `models/best_model_20pct.pth`
- `yolov8m-pose.pt`
- `dataset/BDD_dataset.zip` (для обучения)
- `videos/` (примеры)

## 8. ФОРМАТ ВХОДНЫХ ДАННЫХ

**Файл:** `poses.jsonl`

Формат: JSON Lines, где каждая строка - кадр с позами от YOLOv8.

**Структура:**
```json
{
    "video_name": "video.mp4",
    "fps": 30,
    "frames": [
        {
            "frame_number": 0,
            "timestamp": 0.0,
            "pose_landmarks": [...],
            "pose_world_landmarks": [...]
        }
    ]
}
```

## 9. REQUIREMENTS

```
torch>=2.0.0
numpy>=1.24.0
opencv-python>=4.8.0
scikit-learn>=1.3.0
jsonlines>=3.1.0
librosa>=0.10.0
soundfile>=0.12.0
fastdtw>=0.3.4
scipy>=1.11.0
```

## 10. ТОЧНОСТЬ МОДЕЛИ

- **Архитектура:** TCN + GRU
- **Обучена на:** 20% датасета BDD
- **Accuracy:** ~63%
- **Classes:** 13 латинских фигур

## КОНЕЦ
