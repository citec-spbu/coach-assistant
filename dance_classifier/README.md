# Dance Classifier

Классификатор танцевальных движений с метриками качества исполнения.

## Использование

```python
from dance_classifier.inference.predict import DanceClassifierPredictor

predictor = DanceClassifierPredictor(
    model_path="best_model_20pct.pth",
    reference_dir=None,  # Автоматически найдет в reference_trajectories/
    videos_dir=None
)

result = predictor.predict_from_poses("poses.jsonl", video_path="video.mp4")
```

## Структура

- data_preparation/ - подготовка данных и извлечение признаков
- training/ - обучение моделей
- inference/ - предсказание и метрики качества
- utils/ - DTW-метрики (spatial_similarity, balance, timing, classifier_clarity)
- reference_trajectories/ - эталонные траектории для сравнения

## Модели

- GRU - рекуррентная нейронная сеть
- TCN - временная свёрточная сеть
- Hybrid - комбинация TCN + GRU

## Метрики качества исполнения

Классификатор возвращает 4 метрики качества исполнения танцевальной фигуры:

1. **Spatial Similarity (Техника)** - оценка 0-100
   - Сравнивает движения танцора с эталонной траекторией через DTW
   - Показывает, насколько точно повторяются движения эталона
   - Чем выше, тем лучше техника

2. **Classifier Clarity (Разборчивость)** - оценка 0-100
   - Показывает, насколько уверена модель в своем предсказании
   - Анализирует уверенность по скользящим окнам
   - Чем выше, тем четче и однозначнее выполняется фигура

3. **Timing (Ритм)** - оценка 0-100
   - Проверяет синхронизацию шагов с битами музыки
   - Требует video_path для извлечения аудио
   - Показывает, насколько танцор попадает в такт

4. **Balance (Баланс)** - оценка 0-100
   - Оценивает устойчивость и правильность осанки
   - Анализирует наклон корпуса и центр масс
   - Показывает стабильность корпуса во время исполнения

Все метрики вычисляются автоматически при вызове `predict_from_poses()` с `compute_metrics=True`.

